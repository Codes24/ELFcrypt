# ELFcrypt

MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMNNNNNNNNNNNNNNNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMNNNNNddyhhdmddhddNNmmNNNNNNNNNNNNMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMNNNNmdyo+/---....-----::/++oymNNNNNNNNNNNNNNNMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMNmdyo/-..```````````...........-/smNNNNNNNNNNNNNNNNMMMMMMMMMMMMMMMMMM
MMMMMMMMNNmmy:..```````````..................:ohmmmNNNNNNNNNNNNNNMMMMMMMMMMMMMMM
MMMMMNNNNNmo.``.....`````.................---..-/hmmmmmNNNNNNNNNNNNNMMMMMMMMMMMM
MMMNNNNNNds........`````................----------odmmmmmmmNNNNNNNNNNNNMMMMMMMMM
NNNNNNNmdy-........```..........----------::::::---+hmmmmmmmmmmNNNNNNNNNNMMMMMMM
NNNNNNNhd:.........``.....-----:::::::::::::::::----:ymmmmmmmmmmmNNNNNNNNNNMMMMM
NNNNNNmdo..............---:::::::::::::::::::::-:----:hddmmmmmmmmmmmNNNNNNNNNMMM
NNNmmmmy-.......-....---:::::::::----::::::::---:---.-:yddddmmmmmmmmmmNNNNNNNNNM
NNmmmmh:.....----...------::::::::::::::::------::--..-:ydddddmmmmmmmmmmNNNNNNNN
mmmmmmo......--------..---.--:::::---::::-...-:oo+:---::/dddddddmmmmmmmmmNNNNNNN
mmmmmh:....---------.-/+/---..--.---:::----.-:ssos+/+ss+:yddddddddmmmmmmmmmNNNNN
mmmmds-..----::::--..:o++so+/:---:/+ossoo+osyys++ooohdyo/oddddddddddmmmmmmmmNNNN
mmmmds-.:--::////--../++o+shhhyyyhhyo/--:+shhso/:++oshhso+hddddddddddmmmmmmmmmNN
mmdddy.-+yyysooo+:-../++///+oshdhyyo/:/++oyyys+//+/::+yso+yddddddddddddmmmmmmmNN
mdddds.-:yhhdhyyo:-..:+++--:/ohy+//::sdddh+/yyyys+:/oo+:+oydddddddddddddmmmmmmmN
mdddds.-:+ysdmdhs/-.--::+ssyyys://::oddhhdyoss+oooyhyso++oydddddddddddddmmmmmmmm
dddddh---:shhhhyyyo:::/+oooooo++/:++sddoodmsoshmmmmdysossoydddddddddddddddmmmmmm
ddddddo:--/yhssyyyyyoooydddhhyso::ooyys+/yyssshmmmmmhssss+hddddddddddddddddmmmmm
ddddddho-::+syssosyyyhdmmmmmmhs/::+////+sso+/+sydmmmhyys++ddddddddddddddddddmmmm
dddddddo--:/oyysyyddyyhhdmddhys/:::----/+---:++oyhddhyso/oddddddddddddddddddmmmm
dddddddo+:::/osyhdmmyssyddhhsoo/:/--::-/+//oyysoyydhysooshddddddddddddddddddmmmm
dddddddys+:::+syyhhdhssssyyhodds+//+oyyyyhmmmmmyosyysoshhddddddddddddddddddddmmm
dddddddds+////ossyyhhssssssssydyyydmdmdhhdddmmho+ohhyyhddddddddddddddddddddddmmm
ddddddddy++/:/+oosyyhyysysooos++++yh+ooshho+o+/:oshhyhdddddddddddddddddddddddmmm
ddddddddho//::+o++osydhyhyooossoo+++/::+osssssyyoshyyddddddddddddddddddddddddmmm
ddddddddds//:::+o/oo+dmddhyssoossooso+oyhhddddddsoysyddddddddddddddddddddddddmmm
dddddddhhy+:::::++++-+hddddysssoooo+++shdhysyhyyo+sohddddddddddddddddddddddddmmm
ddddddddhhs--:--/+//-.ohhdhyhhhyo//-:/ooooshddhyhysydddddddddddddddddddddddddmmm
dddddddhhy+-----:/::-:+oydhyhdddhys+oyhhhdmmNmmmmoydddddddddddddddddddddddddmmmm
ddddddhhyy/---..-:-:/ys:/yyyyhmmmmmhhddmmNNmhyhmdosdddddddddddddddddddddddddmmmm
ddddddddhh::---.--+hhhhh/.:+oyhhdmmdddmmmmy:..oNmhooyhhddddddddddddddddddddmmmmm
ddddddddds:+------yhoshdds-``..--+shdmmmd+-..-hNNmhho++oossyhddddddddddddddmmmmm
ddddddddd+:+/-----oh/:ohddh+-...--:+hdmh:.```.omNNmhmmdhyssoyyhhdmmmmmmmmmmmmmmm
mdddddddd////----:+ys:-:yddmho/::---:oh-``````.:hNNmddmmNNmhyyyhdNNNNNNNNNNNNmmm
mdddddddh///:-::::+ohy/..+hdhhmddhs/--/::/+oosyhmNNNNmddNNNNymshsdmdNssydNNNNNNN
mmmddddho://:-+o///+shdo-../omNmNNNmdhdmNNmmmmNNNNNNNNNdhmmmddhdNhyhmymoNNyNNNNN
mmmmdho+o++o+/o+//++ohmmy-..omNNNNNNNNmdhyssyyhhhdNNdhhysssyydyhN+dhohddmdhmNNNM
mdhysosyyyhdyss//++oshmNNh/.omNmmNNNmdo/::--::://sNdyyyyyyssshmmmhNmydmNNssmNNNN
yosyyhysyyhhhds/++osydmNNNms-hNNNNmy+/-.......---omdhhyyhhysssdNNmmhmmNdhsNNmNNN
ddhhyyyshdNdsdy+oosyhmNNNNNNy/syys/-...........--:hNdhhhhhyyhdmNNdmsNNdhomNNNNNN
ssyhmNhhdNNNNdyossydmNNNNNNNNd+--...............--sNdhddddmmmNNNNNNmsNddhmNNNNNN
dsyhmNdmmNmNhshsohmNNNNNNNNNNNm/.............``..-:dNmmmddNNmhNmmNNmdmhNNmNNNNNd
ssyNNNNhddhNyyhyymNNNNNNNNNNNNNd:............``..-:yNNNNmdNNhsNNNNNNNNyyNNNNNNNm
shmhmNNohhoNyhymNmdmNNNNNNNNNNNNh:............`..-:smNNNNhmNhyhmmNmNNNsdNNNNNNNN
hhym+mhsmmoomNmmhdddmmNNNNNNNNNNNm/........:.....-:smNNNNdmNmmNmhd+NNNdNNmNNNNNN
yyy+sNNysshmNNmdNhsyydNNNNNNNNNNNNm/..............-+mNNmNNdNmhNsdsdyNNNdmdddmNNN
+/NhyNddyhyyNNmNmshyhmdmNNNNNNNNNNNN+.........``..-:hNNNmNmmdmmoNymNNNNNNNNNNNNN
m+NNmhNdMMMMNMNdhddNmNmNNNNNNNNNNNNNm/........``...-omNNNNmdNdh+mNNNNNNdNNNNNNNN

## How to Use

Quickstart:

```
% make
gcc -Wall -o ELFcrypt ELFcrypt.c
gcc -Wall -o example example.c
% ./ELFcrypt example
ELFcrypt by @dmfroberson

Crypting .crypted section of example, outputting to crypted

Enter passphrase: harharhar
Confirm passphrase: harharhar
% ./crypted
Enter passphrase: harharhar
Confirm passphrase: harharhar
This function was crypted
```

To use this in future projects, include ELFcrypt.h, add a call to
ELFdecrypt() to main(), and prefix your functions that you'd like to
protect with CRYPTED. After this make-believe C program is compiled,
run ELFcrypt against it with whatever password you desire and it will
be encrypted with RC4. See example.c for more details.

This also will attempt to read the ELFCRYPT environment variable as
input for the password:

```
% ELFCRYPT="harharhar" ./crypted
This function was crypted
```
